<div *ngIf="!userId" class="w-full h-full flex items-center justify-center">
    <p class="text-gray-500 text-lg">Selecione algu√©m para conversar</p>
</div>

<div class="flex justify-between items-center w-full h-16 border-b p-2" *ngIf="userId">
    <div class="flex items-center gap-2">
        <div class="flex items-center gap-2">
            <div class="flex items-center gap-2">
                <button class="sm:hidden text-black px-2 py-2 rounded-md flex items-center" (click)="onBackClick()">
                    <spartan-icon iconName="lucideArrowLeft" iconSize="base"
                        class="flex items-center justify-center"></spartan-icon>
                </button>
                <div class="w-10 h-10 rounded-full overflow-hidden bg-gray-200">
                    <img *ngIf="userPhoto" [src]="userPhoto" class="w-full h-full object-cover" />
                </div>
            </div>
            <div class="flex flex-col">
                <h3 class="text-lg font-bold">{{ userName }}</h3>
            </div>
        </div>
    </div>
</div>

<!-- message display -->
<div class="flex flex-col flex-grow w-full overflow-y-auto p-2 gap-2" *ngIf="userId">
    <div class="flex flex-col flex-grow w-full overflow-y-auto p-2 gap-2" *ngIf="userId">
        <ng-container *ngFor="let msg of messages">
            <div class="flex flex-col p-2 rounded-sm max-w-[70%]" [ngClass]="{
        'self-end items-end bg-[#159A9C] text-white': msg.userId === currentUserId,
        'self-start items-start bg-slate-100 text-black': msg.userId !== currentUserId
      }">
                <p>{{ msg.text }}</p>
                <div class="flex items-center gap-2 mt-1 text-sm">
                    <p class="opacity-50">{{ msg.createdAt | date: 'shortTime' }}</p>
                    <ng-container *ngIf="msg.userId === currentUserId">
                        <spartan-icon *ngIf="msg.read == true" iconName="lucideCheckCheck" iconSize="sm"
                            class="text-white flex items-center"></spartan-icon>
                        <spartan-icon *ngIf="msg.read != true" iconName="lucideCheckCheck" iconSize="sm"
                            class="opacity-50 flex items-center"></spartan-icon>
                    </ng-container>
                </div>
            </div>
        </ng-container>
    </div>
</div>

<!-- message input -->
<div class="w-full border-t p-2 flex items-center gap-2" *ngIf="userId">
    <input type="text" placeholder="Digite sua mensagem..."
        class="flex-1 border rounded-md px-4 py-2 focus:outline-none" [(ngModel)]="messageText"
        (keyup.enter)="sendMessage()" />

    <button class="bg-[#159A9C] text-white px-4 py-2 rounded-md hover:bg-[#127f80] flex items-center"
        (click)="sendMessage()">
        <spartan-icon iconName="lucideSendHorizontal" iconSize="base" class="flex items-center"></spartan-icon>
    </button>
</div>